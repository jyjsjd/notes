---
title: 不可重复读和幻读的区别
created: '2019-02-13T02:39:21.299Z'
modified: '2019-02-13T02:44:25.296Z'
tags: [数据库]
---

# 不可重复读和幻读的区别

* 不可重复读：T1 读取某个范围的数据，T2 在这个范围内插入新的数据，T1 再次读取这个范围的数据，此时读取的结果和和第一次读取的结果不同。

* 幻读：T1 读取某个范围的数据，T2 在这个范围内插入新的数据，T1 再次读取这个范围的数据，此时读取的结果和和第一次读取的结果不同。

`不可重复读`只需要锁住满足条件的记录；`幻读`要锁住满足条件及其相近的记录。

不可重复读重点在于 `update` 和 `delete`，而幻读的重点在于 `insert`。

如果使用锁机制来实现这两种隔离级别，在可重复读中，第一次读取到数据后，就将这些数据加锁，其它事务无法修改这些数据，就可以实现可重复读了；但这种方法却无法锁住 `insert` 的数据，所以当事务A先前读取了数据，或者修改了全部数据，事务B还是可以insert数据提交，这时事务A就会发现莫名其妙多了一条之前没有的数据，这就是幻读，不能通过行锁来避免。需要 `Serializable` 隔离级别，读用读锁，写用写锁，读锁和写锁互斥，这么做可以有效的避免幻读、不可重复读、脏读等问题，但会极大的降低数据库的并发能力。
